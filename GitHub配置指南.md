# GitHub 在线存储配置指南

## 🎯 功能说明

系统现已支持 GitHub 在线存储，具备以下特性：

✅ **数据在线共享** - 所有人访问同一个仓库，看到相同的数据
✅ **实时同步** - 添加/删除日志后自动推送到 GitHub
✅ **版本管理** - GitHub 自动保存每次修改的历史记录
✅ **多设备访问** - 任何设备打开网页都能看到最新数据
✅ **本地缓存** - 离线时也能查看已加载的数据

---

## 📋 前置准备

在配置前，请确保：
1. ✅ 已注册 GitHub 账号
2. ✅ 已创建仓库（例如：update-log）
3. ✅ 仓库设置为 Public（公开）
4. ✅ 已将项目文件上传到仓库

---

## 🔑 第一步：获取 GitHub Token

GitHub Token 是访问仓库的密钥，请按以下步骤获取：

### 详细步骤

1. **登录 GitHub**
   - 访问 https://github.com
   - 登录你的账号

2. **进入设置页面**
   - 点击右上角头像
   - 选择"Settings"（设置）

3. **打开开发者设置**
   - 左侧菜单滚动到最底部
   - 点击"Developer settings"

4. **创建 Token**
   - 点击"Personal access tokens"
   - 选择"Tokens (classic)"
   - 点击"Generate new token"
   - 选择"Generate new token (classic)"

5. **填写 Token 信息**
   ```
   Note (备注): update-log-system
   Expiration (过期时间): No expiration（永不过期）
   ```

6. **选择权限**
   - ✅ 勾选 **repo**（勾选整个 repo，子项会自动勾选）
   - 其他权限不需要勾选

7. **生成并保存**
   - 滚动到底部，点击"Generate token"
   - **立即复制生成的 Token**（以 `ghp_` 开头）
   - ⚠️ Token 只显示一次，关闭页面后无法再次查看！

### 快速链接

直接访问：https://github.com/settings/tokens

---

## ⚙️ 第二步：配置系统

1. **打开配置页面**
   - 访问网站首页
   - 点击"GitHub 配置"按钮
   - 或直接访问 `config.html`

2. **填写配置信息**

   | 字段 | 说明 | 示例 |
   |------|------|------|
   | GitHub 用户名 | 你的 GitHub 用户名 | `zhangsan` |
   | 仓库名称 | 更新日志仓库的名称 | `update-log` |
   | 分支名称 | 通常是 main 或 master | `main` |
   | GitHub Token | 刚才生成的 Token | `ghp_xxxxxxxxxxxx` |

3. **保存并测试**
   - 点击"保存配置并测试连接"
   - 系统会自动测试连接是否成功
   - 成功后会显示绿色提示

---

## 🚀 第三步：开始使用

### 管理页面（添加日志）

1. 打开 `update-log.html`
2. 顶部会显示 GitHub 连接状态（蓝色横幅）
3. 点击"添加更新日志"，填写内容
4. 点击"提交"后，数据会自动同步到 GitHub
5. 可以点击仓库链接，去 GitHub 查看 `data/logs.json` 文件

### 查看页面（浏览日志）

1. 打开 `view.html`
2. 页面会自动从 GitHub 加载最新数据
3. 点击"刷新数据"可以手动重新加载
4. 所有访问者看到的都是相同的数据

---

## 💡 常见问题

### Q1: 配置成功后，数据存储在哪里？

**A:** 数据存储在你的 GitHub 仓库中，路径为 `data/logs.json`。

你可以：
- 在 GitHub 网页查看这个文件
- 查看文件的修改历史
- 下载文件备份

### Q2: 为什么添加日志后，别人还看不到？

**A:** 可能的原因：
1. 对方浏览器有缓存，让他点击"刷新数据"按钮
2. 对方也需要配置 GitHub 连接（或者等 GitHub Pages 自动部署完成）
3. 网络延迟，稍等片刻再刷新

### Q3: Token 丢失了怎么办？

**A:** Token 丢失后无法找回，只能重新生成：
1. 访问 https://github.com/settings/tokens
2. 删除旧 Token
3. 按照上面的步骤重新生成新 Token
4. 在配置页面更新新 Token

### Q4: 数据会不会丢失？

**A:** 不会！数据的三重保障：
1. GitHub 仓库存储（主要）
2. 浏览器本地缓存（备份）
3. GitHub 自动版本管理（历史记录）

### Q5: 可以不配置 GitHub 吗？

**A:** 可以！如果不配置：
- 数据仅存储在浏览器本地
- 不同人看到的数据不同
- 需要通过 Excel 导入导出来共享数据

### Q6: Token 安全吗？

**A:** Token 的安全建议：
- ✅ Token 存储在浏览器的 localStorage 中
- ✅ 只赋予了 repo 权限，权限最小化
- ⚠️ 不要把 Token 分享给他人
- ⚠️ 不要在公共电脑上使用
- ⚠️ 定期更换 Token（建议每6个月一次）

### Q7: 配置失败怎么办？

**A:** 检查清单：
- [ ] GitHub 用户名是否正确？
- [ ] 仓库名称是否正确？
- [ ] 仓库是否设置为 Public（公开）？
- [ ] Token 是否完整复制（包括 `ghp_` 前缀）？
- [ ] Token 是否勾选了 repo 权限？
- [ ] 网络是否正常？（能否访问 GitHub）

### Q8: 如何查看数据文件？

**A:** 访问你的仓库：
```
https://github.com/你的用户名/仓库名/blob/main/data/logs.json
```

例如：
```
https://github.com/zhangsan/update-log/blob/main/data/logs.json
```

### Q9: 可以多人同时编辑吗？

**A:** 技术上可以，但不推荐！

- ⚠️ 如果两人同时提交，后提交的会覆盖先提交的
- ✅ 建议：指定一个管理员负责添加日志
- ✅ 或者：约定好时间分开编辑

### Q10: 数据文件变得很大怎么办？

**A:**
1. 定期导出备份并清空旧数据
2. 或者创建新仓库存储新一年的数据
3. GitHub 对单文件大小有100MB限制，一般不会超过

---

## 🎓 使用技巧

### 技巧1：查看修改历史

GitHub 会自动记录每次修改：
1. 访问 `data/logs.json` 文件页面
2. 点击右上角"History"
3. 可以看到每次修改的时间和内容
4. 甚至可以恢复到之前的版本

### 技巧2：多设备同步

配置好后，在任何设备上：
1. 打开网站
2. 进入配置页面，输入相同的信息
3. 即可访问同一份数据

### 技巧3：紧急恢复

如果数据意外清空：
1. 去 GitHub 查看 `data/logs.json` 的历史记录
2. 找到最近一次正常的版本
3. 复制内容
4. 在管理页面点击"导入数据"上传

### 技巧4：离线使用

配置 GitHub 后，系统会缓存数据：
- 在线时：自动从 GitHub 同步
- 离线时：使用本地缓存查看
- 重新联网后：自动同步最新数据

---

## 📊 数据流向图

```
添加日志
   ↓
保存到 GitHub 仓库 (data/logs.json)
   ↓
同时缓存到浏览器本地
   ↓
其他用户刷新页面
   ↓
从 GitHub 加载最新数据
```

---

## 🔧 高级配置

### 私有仓库

如果你的仓库是 Private（私有）：
1. Token 权限需要包括 repo
2. 只有有权限的人才能访问
3. GitHub Pages 需要升级到付费版才能部署私有仓库

### 自定义分支

如果你想使用其他分支（不是 main）：
1. 在配置页面修改分支名称
2. 确保该分支已存在
3. 数据会保存到该分支

### 备份策略

建议的备份方案：
1. **自动备份**：GitHub 已经自动版本管理
2. **手动备份**：每月导出一次 Excel 文件
3. **异地备份**：关键数据上传到网盘

---

## 🆘 获取帮助

如果遇到无法解决的问题：

1. 查看浏览器控制台（F12）的错误信息
2. 检查 GitHub 仓库的 Actions 页面是否有错误
3. 在仓库的 Issues 中提问
4. 查阅 GitHub API 文档：https://docs.github.com/rest

---

## ✅ 配置检查清单

部署前请确认：

- [ ] GitHub Token 已正确生成并复制
- [ ] 配置页面测试连接成功
- [ ] 管理页面显示 GitHub 在线存储已启用
- [ ] 添加测试日志，查看 GitHub 仓库中是否生成 data/logs.json
- [ ] 查看页面能正常显示数据
- [ ] 其他人访问也能看到数据

---

## 🎉 完成！

配置成功后，你就拥有了一个：
- ✅ 在线共享的更新日志系统
- ✅ 自动版本管理的数据存储
- ✅ 多设备同步的协作平台
- ✅ 永久保存的历史记录

享受高效的团队协作吧！ 🚀
